### bibliotecas
if (!require("phytools")) install.packages("phytools"); library("phytools")
if (!require("geiger")) install.packages("geiger"); library("geiger")
### carregando dados fenotípicos
bacteria.data<-read.csv("dados/bac_rates.csv", row.names=1)
head(bacteria.data,3)
### carregando filogenia
bacteria.tree<-read.tree("dados/bac_rates.phy")
print(bacteria.tree,printlen=2)
### valores de interesse em um vetor nomeado
genome_size<-bacteria.data[,"Genome_Size_Mb"]
names(genome_size)<-rownames(bacteria.data)
genome_size
### verificando a distribuição dos valores
hist(genome_size)
### verificando correspondência entre dados e filogenia
name.check(bacteria.tree,bacteria.data)
### gráfico da filogenia
plotTree(bacteria.tree,
ftype="i",
fsize=0.5,
lwd=1,
mar=c(2.1,2.1,0.1,1.1)
)
### gráfico da filogenia
plotTree(bacteria.tree,
X= genome_size,
ftype="i",
fsize=0.5,
lwd=1,
mar=c(2.1,2.1,0.1,1.1)
)
### gráfico da filogenia
phylo.barplot(bacteria.tree,
dat= genome_size,
ftype="i",
fsize=0.5,
lwd=1,
mar=c(2.1,2.1,0.1,1.1)
)
### gráfico da filogenia
plotTree.barplot(phylo = bacteria.tree,
dat= genome_size,
ftype="i",
fsize=0.5,
lwd=1,
mar=c(2.1,2.1,0.1,1.1)
)
### gráfico da filogenia
plotTree.barplot(tree = bacteria.tree,
dat= genome_size,
ftype="i",
fsize=0.5,
lwd=1,
mar=c(2.1,2.1,0.1,1.1)
)
### gráfico da filogenia
plotTree.barplot(tree = bacteria.tree,
x = genome_size,
ftype="i",
fsize=0.5,
lwd=1,
mar=c(2.1,2.1,0.1,1.1)
)
### gráfico da filogenia
plotTree.barplot(tree = bacteria.tree,
x = genome_size,
ftype="i",
fsize=0.25,
lwd=1
)
### gráfico da filogenia
plotTree.barplot(tree = bacteria.tree,
x = genome_size,
ftype="i",
fsize=0.1,
lwd=1
)
axis(1,at=seq(0,1,length.out=5),cex.axis=0.8)
### gráfico da filogenia
plotTree.barplot(tree = bacteria.tree,
x = genome_size,
args.plotTree=list(fsize=0.7)
)
### ajustando o modelo BM aos valores
fitBM <-fitContinuous(phy = bacteria.tree,
dat = genome_size,
model ="BM"
)
## verificar resultados!
fitBM
### ajustando o modelo BM
fitDIR <-fitContinuous(phy = bacteria.tree,
dat = genome_size,
model ="mean_trend"
)
## verificar resultados!
fitDIR
## verificar resultados!
fitBM
### ajustando o modelo BM
fitWN <-fitContinuous(phy = bacteria.tree,
dat = genome_size,
model ="WN"
)
### ajustando o modelo BM
fitWN <-fitContinuous(phy = bacteria.tree,
dat = genome_size,
model ="white"
)
## verificar resultados!
fitWN
### ajustando o modelo BM
fitBM <-fitContinuous(phy = bacteria.tree,
dat = genome_size,
model ="BM"
)
## verificar resultados!
fitBM
fitWN
fitDIR
### ajustando o modelo Direcional
fitEB <-fitContinuous(phy = bacteria.tree,
dat = genome_size,
model ="EB"
)
## verificar resultados!
fitEB
### ajustando o modelo Direcional
fitEB <-fitContinuous(phy = bacteria.tree,
dat = genome_size,
model ="EB",
a = list(-0.0000001, 1)
)
### ajustando o modelo Direcional
fitEB <-fitContinuous(phy = bacteria.tree,
dat = genome_size,
model ="EB",
bounds = list(-0.0000001, 1)
)
## verificar resultados!
fitEB
